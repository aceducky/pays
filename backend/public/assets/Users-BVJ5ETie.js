import{c as D,e as A,l as G,f as H,r as w,u as J,j as s,n as M}from"./index-CG82LQ2M.js";import{L as O}from"./LoadingText-BT_EYzz6.js";import{P as W}from"./Pagination-DtZ54bI8.js";import{q as Z,C as I}from"./user.zodSchema-7othgA9e.js";import"./createLucideIcon-Cij5YIqx.js";const ee=e=>{const t=D.c(11),{filter:i,page:r,limit:d,enabled:m}=e,a=i===void 0?"":i,o=r===void 0?1:r,l=d===void 0?5:d,x=m===void 0?!1:m;let c;t[0]!==a||t[1]!==o?(c=[G,{filter:a,page:o}],t[0]=a,t[1]=o,t[2]=c):c=t[2];let u;t[3]!==a||t[4]!==l||t[5]!==o?(u=async()=>{const{data:h}=await H.get("/user/bulk",{params:{filter:a,page:o,limit:l}});return h.data},t[3]=a,t[4]=l,t[5]=o,t[6]=u):u=t[6];let f;return t[7]!==x||t[8]!==c||t[9]!==u?(f={queryKey:c,queryFn:u,retry:!1,keepPreviousData:!0,enabled:x,select:te},t[7]=x,t[8]=c,t[9]=u,t[10]=f):f=t[10],A(f)};function te(e){return{users:e?.users||[],pagination:{page:e?.pagination?.page||1,pages:e?.pagination?.pages||1}}}function se(e,t){const i=D.c(4),r=t,[d,m]=w.useState(e);let a,o;return i[0]!==r||i[1]!==e?(a=()=>{const l=setTimeout(()=>{m(e)},r);return()=>{clearTimeout(l)}},o=[e,r],i[0]=r,i[1]=e,i[2]=a,i[3]=o):(a=i[2],o=i[3]),w.useEffect(a,o),d}function ae(){const e=D.c(45),[t,i]=w.useState(""),[r,d]=w.useState(1);let m;e[0]!==t||e[1]!==r?(m=()=>t===""&&r===1,e[0]=t,e[1]=r,e[2]=m):m=e[2];const[a,o]=w.useState(m),l=se(t,500),x=J();let c=null;if(l!==""){let n;e[3]!==l?(n=Z.safeParse(l),e[3]=l,e[4]=n):n=e[4];const z=n;z.success||(c=z.error?.issues?.[0]?.message||"Invalid username format")}const u=l===""||l.length>=3&&!c,f=a&&u;let h;e[5]!==l||e[6]!==r||e[7]!==f?(h={filter:l,page:r,limit:5,enabled:f},e[5]=l,e[6]=r,e[7]=f,e[8]=h):h=e[8];const{data:p,isLoading:g,isFetching:K,isError:b,error:L}=ee(h);let E;e[9]!==p?.users?(E=p?.users||[],e[9]=p?.users,e[10]=E):E=e[10];const P=E;let _;e[11]!==p?.pagination?(_=p?.pagination||{},e[11]=p?.pagination,e[12]=_):_=e[12];const{page:Q,pages:Y}=_,V=Q===void 0?1:Q,$=Y===void 0?1:Y;let U;e[13]===Symbol.for("react.memo_cache_sentinel")?(U=()=>{d(1),o(!0)},e[13]=U):U=e[13];const X=U;let F;e[14]!==x?(F=n=>{x("/payment",{state:{receiverUserName:n}})},e[14]=x,e[15]=F):F=e[15];const B=F,T=c&&t===l;let k;e[16]===Symbol.for("react.memo_cache_sentinel")?(k=s.jsx("div",{className:"flex items-center justify-between mb-4",children:s.jsx("h3",{className:"text-xl font-bold",children:"Search users"})}),e[16]=k):k=e[16];let q,R;e[17]===Symbol.for("react.memo_cache_sentinel")?(q=n=>i(n.target.value),R=n=>{n.key==="Enter"&&X()},e[17]=q,e[18]=R):(q=e[17],R=e[18]);let j;e[19]!==t?(j=s.jsx("div",{className:"mb-4 flex gap-2 w-full",children:s.jsxs("label",{className:"input w-full focus-within:outline-none",children:["@",s.jsx("input",{autoFocus:!0,className:"w-full focus-within:outline-none",placeholder:"Search users by username...",value:t,onChange:q,onKeyDown:R})]})}),e[19]=t,e[20]=j):j=e[20];let N;e[21]!==T||e[22]!==c?(N=T&&s.jsxs("div",{className:"alert alert-warning mb-4",children:[s.jsx(I,{}),c]}),e[21]=T,e[22]=c,e[23]=N):N=e[23];let y;e[24]!==g?(y=g&&s.jsx(O,{}),e[24]=g,e[25]=y):y=e[25];let v;e[26]!==L||e[27]!==b?(v=b&&s.jsxs("div",{className:"alert alert-error",children:[s.jsx(I,{}),M(L)]}),e[26]=L,e[27]=b,e[28]=v):v=e[28];let S;e[29]!==V||e[30]!==B||e[31]!==b||e[32]!==K||e[33]!==g||e[34]!==u||e[35]!==a||e[36]!==$||e[37]!==P?(S=!g&&!b&&a&&s.jsxs("div",{className:"flex flex-col gap-4 mb-6",children:[P.length===0&&u?s.jsx("div",{className:"alert alert-info",children:"No users found."}):P.map(n=>s.jsxs("div",{className:"card bg-base-200 shadow p-4 flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"text-lg",children:["@",n.userName]}),s.jsx("div",{className:"text-base-content/80 text-sm",children:n.fullName})]}),s.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:()=>B(n.userName),children:"Pay"})]},n.userName)),u&&s.jsx(W,{currentPage:V,totalPages:$,onPageChange:d,isFetching:K,className:"mt-2"})]}),e[29]=V,e[30]=B,e[31]=b,e[32]=K,e[33]=g,e[34]=u,e[35]=a,e[36]=$,e[37]=P,e[38]=S):S=e[38];let C;return e[39]!==j||e[40]!==N||e[41]!==y||e[42]!==v||e[43]!==S?(C=s.jsxs("div",{className:"w-full max-w-2xl mx-auto h-full flex flex-col",children:[k,j,N,y,v,S]}),e[39]=j,e[40]=N,e[41]=y,e[42]=v,e[43]=S,e[44]=C):C=e[44],C}function ce(){const e=D.c(1);let t;return e[0]===Symbol.for("react.memo_cache_sentinel")?(t=s.jsx(s.Fragment,{children:s.jsx("div",{className:"overflow-hidden",children:s.jsx(ae,{})})}),e[0]=t):t=e[0],t}export{ce as default};
